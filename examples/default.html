<html>
<head>

<!--<script src="https://cdn.chec.io/js/embed.js"></script>-->
<!--<script src="../build/embed.js"></script>-->
<script src="../build/embed.unminified.js"></script>
<!-- Including multiple times so we can test the "no conflict" handling logic -->
<script src="../build/embed.unminified.js"></script>
<script src="../build/embed.unminified.js"></script>
</head>

<body>

<h1>Embed test buttons</h1>
<h2>Direct elements</h2>
<p><em>Direct elements are elements that are available on page load.</em></p>

<p>This is a direct element with a Chec URL, and a heading inside the anchor:</p>
<a href="https://checkout.chec.io/C2zt3f"><h1>Buy now</h1></a>

<p>This is a direct element with a Chec URL, and a data-chec-product-id attribute:</p>
<a href="https://checkout.chec.io/C2zt3f?some=querystring" data-chec-product-id="C2zt3f">Buy now</a>

<p>This is a direct element with no URL but a data-chec-product-id attribute, and two nested spans:</p>
<a href="http://google.com/foo/bar?baz" data-chec-product-id="C2zt3f"><span><span>Buy now</span></span></a>

<p>This is a direct element that is not a Chec URL and has no Chec data attribute (should work normally):</p>
<a href="http://google.com">Click me, go on</a>

<h2>Delegated elements</h2>
<p><em>Delegated elements are elements that are NOT available on page load, but are added dynamically afterwards - usually with JavaScript.</em></p>

<button type="button" class="addDelegatedElement" data-href="https://checkout.chec.io/C2zt3f">Add delegated element</button>
<button type="button" class="addDelegatedElement" data-href="https://checkout.chec.io/C2zt3f" data-chec-product-id="C2zt3f">Add delegated element with product ID</button>
<button type="button" class="addDelegatedElement" data-href="https://checkout.chec.io/C2zt3f" data-query-string="foo=bar">Add delegated element with query string</button>
<button type="button" class="addDelegatedElement" data-href="http://google.com/foo/bar?baz" data-query-string="foo=bar">Add delegated element without Chec URL</button>

<div id="delegated"></div>

<script>
    let addButtons = document.getElementsByClassName('addDelegatedElement');
    for (var i = 0, length = addButtons.length; i < length; i = i + 1) {
        addButtons[i].addEventListener('click', function (event) {
            let button = event.target;

            let newElement = document.createElement('a');
            if (button.getAttribute('data-query-string')) {
                newElement.href = button.getAttribute('data-href') + '?' + button.getAttribute('data-query-string');
            } else {
                newElement.href = button.getAttribute('data-href');
            }
            if (button.getAttribute('data-chec-product-id')) {
                newElement.setAttribute('data-chec-product-id', button.getAttribute('data-chec-product-id'));
            }

            newElement.innerHTML = 'Buy now';

            let container = document.createElement('p');
            container.appendChild(newElement);

            document.getElementById('delegated').appendChild(container);
        });
    }
</script>

</body>
</html>
